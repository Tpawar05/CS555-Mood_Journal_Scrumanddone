{% extends "base.html" %}

{% block title %}Weekly Summaries • Mood Journal{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto py-8">
  <a href="/dashboard" class="text-sm text-gray-600 hover:text-gray-900">← Back to Dashboard</a>
  <div class="mt-6 bg-white rounded-xl shadow p-6">
    <h1 class="text-2xl font-bold mb-2">Weekly Summaries</h1>
    <p class="text-gray-600 mb-4">A concise week-by-week view of your moods. Each card shows the week range, average mood, total entries, and notable highs/lows.</p>

    {% if summaries and summaries|length > 0 %}
      <div class="space-y-4">
        {% for s in summaries %}
          <div class="border rounded-lg p-4">
            <div class="flex items-start justify-between">
              <div>
                <div class="text-sm text-gray-500">Week</div>
                <div class="font-semibold">{{ s.week_start.strftime('%b %d, %Y') }} — {{ s.week_end.strftime('%b %d, %Y') }}</div>
                <div class="text-sm text-gray-600">Entries: {{ s.total }} &middot; Average: {{ s.average }}</div>
              </div>
              <div class="text-right">
                {% if s.highest %}
                  <div class="text-sm text-gray-500">Highest</div>
                  <div class="font-semibold">{{ s.highest.mood_rating }} — {{ s.highest.mood_label or '' }}</div>
                  <div class="text-xs text-gray-500">{{ s.highest.entry_date.strftime('%b %d') }}</div>
                {% endif %}
                {% if s.lowest %}
                  <div class="mt-2 text-sm text-gray-500">Lowest</div>
                  <div class="font-semibold">{{ s.lowest.mood_rating }} — {{ s.lowest.mood_label or '' }}</div>
                  <div class="text-xs text-gray-500">{{ s.lowest.entry_date.strftime('%b %d') }}</div>
                {% endif %}
              </div>
            </div>

            {% if s.entries and s.entries|length > 0 %}
              <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-2">
                {% for e in s.entries[:6] %}
                  <div class="p-2 border rounded text-sm">
                    <div class="text-xs text-gray-500">{{ e.entry_date.strftime('%a %b %d') }}</div>
                    <div class="font-medium">{{ e.mood_rating }} — {{ e.mood_label }}</div>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="p-4 bg-amber-50 rounded">
        <p class="text-gray-600">No entries yet to summarize. Try adding some mood entries to see weekly summaries here.</p>
      </div>
    {% endif %}

    <div class="mt-6">
      <a href="/" class="text-amber-600 font-semibold">Return Home</a>
    </div>
  </div>
</div>
{% endblock %}
